#!/bin/bash


cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/1B_R2.json -o fastq/trim_7413_1_1B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_1_1B_R2.fastq.gz --too-long-output fastq/long_7413_1_1B_R2.fastq.gz fastq/7413_1_1B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/2B_R2.json -o fastq/trim_7413_2_2B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_2_2B_R2.fastq.gz --too-long-output fastq/long_7413_2_2B_R2.fastq.gz fastq/7413_2_2B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/3B_R2.json -o fastq/trim_7413_3_3B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_3_3B_R2.fastq.gz --too-long-output fastq/long_7413_3_3B_R2.fastq.gz fastq/7413_3_3B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/4B_R2.json -o fastq/trim_7413_4_4B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_4_4B_R2.fastq.gz --too-long-output fastq/long_7413_4_4B_R2.fastq.gz fastq/7413_4_4B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/5B_R2.json -o fastq/trim_7413_5_5B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_5_5B_R2.fastq.gz --too-long-output fastq/long_7413_5_5B_R2.fastq.gz fastq/7413_5_5B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/6B_R2.json -o fastq/trim_7413_6_6B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_6_6B_R2.fastq.gz --too-long-output fastq/long_7413_6_6B_R2.fastq.gz fastq/7413_6_6B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/7B_R2.json -o fastq/trim_7413_7_7B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_7_7B_R2.fastq.gz --too-long-output fastq/long_7413_7_7B_R2.fastq.gz fastq/7413_7_7B_R2.fastq.gz

cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/1B_R2.json -o fastq/trim_7413_8_1B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_8_1B_R2.fastq.gz --too-long-output fastq/long_7413_8_1B_R2.fastq.gz fastq/7413_8_1B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/2B_R2.json -o fastq/trim_7413_9_2B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_9_2B_R2.fastq.gz --too-long-output fastq/long_7413_9_2B_R2.fastq.gz fastq/7413_9_2B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/3B_R2.json -o fastq/trim_7413_10_3B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_10_3B_R2.fastq.gz --too-long-output fastq/long_7413_10_3B_R2.fastq.gz fastq/7413_10_3B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/4B_R2.json -o fastq/trim_7413_11_4B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_11_4B_R2.fastq.gz --too-long-output fastq/long_7413_11_4B_R2.fastq.gz fastq/7413_11_4B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/5B_R2.json -o fastq/trim_7413_12_5B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_12_5B_R2.fastq.gz --too-long-output fastq/long_7413_12_5B_R2.fastq.gz fastq/7413_12_5B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/6B_R2.json -o fastq/trim_7413_13_6B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_13_6B_R2.fastq.gz --too-long-output fastq/long_7413_13_6B_R2.fastq.gz fastq/7413_13_6B_R2.fastq.gz
cutadapt -n 2 -e 0.2 -M 62 -g AGTCTATAGCTACTAGGCGATATG -a ACCGGAATAGGGATCCATCGATAATTCTTAATT --json Output/7B_R2.json -o fastq/trim_7413_14_7B_R2.fastq.gz --untrimmed-output fastq/untrim_7413_14_7B_R2.fastq.gz --too-long-output fastq/long_7413_14_7B_R2.fastq.gz fastq/7413_14_7B_R2.fastq.gz



bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_1_1B_R2.fastq.gz -S Output/1B_R2.sam --un Output/1B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_2_2B_R2.fastq.gz -S Output/2B_R2.sam --un Output/2B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_3_3B_R2.fastq.gz -S Output/3B_R2.sam --un Output/3B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_4_4B_R2.fastq.gz -S Output/4B_R2.sam --un Output/4B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_5_5B_R2.fastq.gz -S Output/5B_R2.sam --un Output/5B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_6_6B_R2.fastq.gz -S Output/6B_R2.sam --un Output/6B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_7_7B_R2.fastq.gz -S Output/7B_R2.sam --un Output/7B_R2_unaligned.fastq

bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_8_1B_R2.fastq.gz -S Output/1B_R2.sam --un Output/1B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_9_2B_R2.fastq.gz -S Output/2B_R2.sam --un Output/2B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_10_3B_R2.fastq.gz -S Output/3B_R2.sam --un Output/3B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_11_4B_R2.fastq.gz -S Output/4B_R2.sam --un Output/4B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_12_5B_R2.fastq.gz -S Output/5B_R2.sam --un Output/5B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_13_6B_R2.fastq.gz -S Output/6B_R2.sam --un Output/6B_R2_unaligned.fastq
bowtie2 --local -x Data/bowtie/Library -U fastq/trim_7413_14_7B_R2.fastq.gz -S Output/7B_R2.sam --un Output/7B_R2_unaligned.fastq


# count
htseq-count -t gene -s reverse --with-header Output/aligned/filtered/* Data/Library.gtf > output_all_filtered.tsv


